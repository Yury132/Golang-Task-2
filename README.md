<h1 align="center">Задание №2</h1>
<h3 align="left">Необходимо создать сервис реализующий механизм загрузки изображений с автоматическим созданием миниатюр.

Сервис должен выполнять следующий сценарий:
1.	Пользователь загружает картинку используя метод API, например POST /uploads
2.	Сервер сохраняет загруженное изображение на диск и данные о нём в БД, после чего создает задачу в очереди на генерацию миниатюры
3.	Воркер-скрипт подключенный к очереди обрабатывает задачу, получая файл и создавая для него миниатюру, после чего сохраняет её на диск, а информацию о ней в БД
4.	Имеющуюся информацию о загруженных картинках и созданных для них миниатюрах сервер возвращает в отдельном методе, например /uploads/:id

Требования:
1.	Использовать PostgreSQL в качестве базы данных
2.	Использовать Nats JetStream в качестве инструмента для реализации очереди
3.	Размеры для генерации миниатюры должны быть конфигурируемы, в качестве тестовых значений можно использовать границы в 100 пикселей по ширине и высоте, ужимая картинку до данного размера по наибольшей стороне
4.	Для генерации миниатюр предполагается использование библиотеки, например libvips https://github.com/libvips/libvips , и её wrapper для GoLang - https://github.com/davidbyttow/govips
</h3>

<h1 align="center">Развертка</h1>

- Склонировать репозиторий
```
git clone https://github.com/Yury132/Golang-Task-2.git
```
- Установить PostgreSQL в Docker контейнер, используя docker-compose.yml файл из проекта
  
1. Скопировать docker-compose.yml в новую папку "postgresql"
  
2. Выполнить в терминале команду
```
docker compose up
```
- Подключиться к базе данных PostgreSQL (Например, через DBeaver)

POSTGRES_DB: mydb

POSTGRES_USER: root

POSTGRES_PASSWORD: mydbpass

Port: 5432

Host: localhost

- Установить NATS в Docker контейнер командами
```
docker pull nats:latest
```
```
docker run -p 4222:4222 -ti nats:latest -js
```

- Запустить веб-приложение командой
```
go run cmd/main.go
```

<h1 align="center">Тестирование</h1>

- Используя Postman, загрузить изображение, отправив POST запрос

```
http://localhost:8080/uploads?size=100
```
Указав в Body -> form-data -> "Key"="file" и "Value"="image.png"

![alt text](https://github.com/Yury132/test-2/blob/main/forREADME/1.PNG?raw=true)

Указав в Params -> "Key"="size" и "Value"="100"

![alt text](https://github.com/Yury132/test-2/blob/main/forREADME/2.PNG?raw=true)

- Используя Postman, получить данные о всех изображениях и соответствующих им миниатюрах, отправив GET запрос

```
http://localhost:8080/get-data
```

![alt text](https://github.com/Yury132/test-2/blob/main/forREADME/3.PNG?raw=true)

где:

<b>id</b> - Уникальный идентификатор загруженного изображения

<b>name </b> - Название изображения

<b>type</b> - Формат изображения

<b>width</b> - Разрешение загруженного изображения (ширина)

<b>height</b> - Разрешение загруженного изображения (высота)

<b>name_miniature</b> - Название созданной миниатюры

<b>width_miniature</b> - Разрешение созданной миниатюры (ширина)

<b>height_miniature</b> - Разрешение созданной миниатюры (высота)


- Используя Postman, получить данные о конкретном загруженном изображении и созданной для него миниатюре, отправив GET запрос

```
http://localhost:8080/uploads/id
```
где "id" - положительное целое число

- Загруженные изображения и миниатюры будут сохраняться в папке "uploads"
